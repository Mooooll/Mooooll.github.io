import{_ as U,E as T,r as p,C as q,o as Y,e as w,f as _,i as F,w as W,k as v,g as s,j as i,y as I,v as k,T as Z,x as j,a as P,F as G,h as N,s as ee,t as te,G as ne,H as le,I as ae,n as re,p as oe,q as ie}from"./index-8ff337a0.js";import{t as se}from"./type-77009fcd.js";import{m as B}from"./mes-64b9a1a8.js";import"./utils-604c9dcf.js";const ce=["id"],ue={class:"absolute top-0 left-0 w-full h-full bg-neutral-50/70 dark:bg-neutral-900/70 flex flex-wrap overflow-hidden"},de=["id"],fe=["value"],pe={__name:"player",props:{player:{type:Object,default:()=>{}},cnn:{type:Boolean,default:!1},headcount:{type:Number,default:2},working:{type:Boolean,default:!1}},emits:["change","lose","win","get-out","nothing","enqueue"],setup(u,{emit:h}){const a=u,e=c=>{let d=c.target.value;d.length>10&&(B({type:"error",text:"少点字儿吧",time:2e3}),d=c.target.value=d.slice(0,10).trim()),h("change",d,a.player.id)};T(()=>a.cnn,(c,d)=>{!c&&a.player.nickname.length<=0&&(B({type:"error",text:"昵称怎么能空着呢",time:2e3}),h("change",`昵称${a.player.id.slice(-6)}`,a.player.id))});let o=p(!1),y=p(!1),m=q(()=>`dapai${a.player.id}`),E=q(()=>`tc${a.player.id}`),L=q(()=>!a.cnn&&!o.value&&!a.player.bedoing),r=c=>{let d=document.getElementById(m.value);d&&(d.contains(c.target)&&!a.player.bedoing&&!y.value&&o.value?y.value=!0:(o.value=!1,y.value=!1))};T(o,(c,d)=>{setTimeout(()=>{c?window.addEventListener("click",r):window.removeEventListener("click",r)},0)});const S=()=>{a.cnn||a.player.bedoing||(a.working?h("enqueue",a.player.id):o.value=!0)},D=()=>{h("lose",a.player.nickname,a.player.id)},b=()=>{h("win",a.player.nickname,a.player.id)},$=async()=>{if(a.headcount<=2){B({type:"error",text:"玩家人数过少",time:2e3}),o.value=!1;return}y.value&&h("get-out",a.player.nickname,a.player.id,a.player.jetton)},g=()=>{h("nothing",a.player.nickname,a.player.id)};return Y(()=>{window.removeEventListener("click",r)}),(c,d)=>(w(),_("div",{onClickCapture:S,id:i(m),class:j(["relative w-5/12 md:w-1/3 min-h-24 border select-none transition-all flex justify-center items-center flex-col gap-2",{"cursor-pointer":i(L)},u.player.bedoing?"opacity-60 cursor-not-allowed border-purple-600":a.player.me?"border-amber-600":""])},[F(Z,{name:"fade"},{default:W(()=>[v(s("div",ue,[s("div",{onClick:D,class:"doing-btn border-r border-b cursor-pointer"},"支出"),s("div",{onClick:b,class:"doing-btn border-l border-b cursor-pointer"},"通吃"),s("div",{onClick:$,id:i(E),class:"doing-btn border-r border-t cursor-pointer"},I(i(y)?"确认":"退出"),9,de),s("div",{onClick:g,class:"doing-btn border-l border-t"})],512),[[k,i(o)]])]),_:1}),v(s("span",{class:"basis-1/3 text-2xl w-3/4 flex justify-center items-center"},I(u.player.nickname),513),[[k,!u.cnn]]),v(s("input",{type:"text",value:u.player.nickname,onInput:e,class:"basis-1/3 text-2xl text-center w-full border-none outline-none p-0 bg-white dark:bg-neutral-900"},null,40,fe),[[k,u.cnn]]),s("span",{class:j(["break-all text-center",u.player.jetton>0?"text-emerald-500 dark:text-emerald-300":u.player.jetton==0?"":"text-rose-600 dark:text-rose-500"])},I(u.player.jetton),3)],42,ce))}},he=U(pe,[["__scopeId","data-v-dfdec515"]]);const ge=u=>(oe("data-v-9d60422b"),u=u(),ie(),u),ve={key:0,class:"min-h-[80vh] text-2xl flex flex-col justify-center items-center gap-8"},ye={class:"relative w-9/12 max-w-xs flex flex-wrap justify-evenly gap-2"},me=["onClick"],be={key:1,class:"w-full flex flex-col items-center"},xe={class:"btnbox w-full max-w-5xl flex justify-evenly items-start gap-2 select-none"},we={class:"fixed top-0 left-0 w-full h-full p-2 bg-neutral-800/20"},ke=["placeholder","onKeyup"],_e={class:"w-full max-w-5xl my-6 flex flex-col justify-start items-center gap-2"},$e=ge(()=>s("div",{class:"text-lg"},"历史",-1)),Ce={class:"w-full p-2 text-center"},je={__name:"dapai",setup(u){let h=p(!1),a=p(2),e=P([]),o=p(!1);const y=l=>{a.value=l,h.value=!0;for(let n=0;n<l;n++)e.push({id:n.toString(),nickname:`好运${n+1}号`,jetton:0,bedoing:!1,me:!1})};let m=p(!1);const E=()=>{if(o.value){B({type:"error",text:"非法操作",time:2e3});return}m.value=!0},L=()=>{m.value=!1,r.length>0&&r[0]!=""&&x.unshift(`"${r[r.length-1]}" 改名为 "${r[0]}"`),r=[]};let r=[];const S=(l,n)=>{let t=e.indexOf(e.find(C=>C.id==n));r.length>=2&&(e[t].nickname==r[0]?(r.shift(),r.unshift(l)):(x.unshift(`"${r[r.length-1]}" 改名为 "${r[0]}"`),r.length=0)),r.length==0&&(r.unshift(e[t].nickname),r.unshift(l)),e[t].nickname=l},D=()=>{if(o.value){B({type:"error",text:"非法操作",time:2e3});return}e.push({id:new Date().getTime().toString(),nickname:`天问${e.length+1}号`,jetton:0,bedoing:!1,me:!1}),a.value++,x.unshift(`"天问${e.length}号" 加入`)};let b=p(0),$=p("");T(b,(l,n)=>{switch(b.value){case 1:$.value="支出点数";break;case 2:$.value="通吃点数";break;default:$.value="点数";break}});let g;const c=[];let d=p(null);const z=(l,n)=>{o.value=!0,b.value=1;for(let t=0;t<e.length;t++)e[t].id===n&&(e[t].bedoing=!0,g=t)},M=l=>{for(let n=0;n<e.length;n++)e[n].id===l&&(e[n].me=!e[n].me)};let O=p(!1),f=p();T(f,(l,n)=>{l>999&&(f.value=999)});const R=()=>{if(!o.value){B({type:"warn",text:"温馨提示：用于确认收款人",time:2e3});return}for(let l=0;l<e.length;l++)e[l].me===!0&&c.push(e[l].id);for(let l=0;l<e.length&&e[l].me!=!0;l++)if(l>=e.length-1){H();return}O.value=!0,K()},A=(l,n)=>{o.value=!0,b.value=2;for(let t=0;t<e.length;t++)e[t].id===n&&(e[t].bedoing=!0,g=t);O.value=!0,K()},J=(l,n,t)=>{e.splice(e.indexOf(e.find(C=>C.id==n)),1),a.value--,x.unshift(`"${l}" 退出 金额为 ${t}`)},Q=(l,n)=>{for(let t=0;t<e.length;t++)e[t].id===n&&(e[t].bedoing=!0,setTimeout(()=>{e[t].bedoing=!1},0))},X=()=>{switch(b.value){case 1:let l=[];for(let n=0;n<c.length;n++){let t=e.indexOf(e.find(C=>C.id==c[n]));e[t].jetton+=f.value,e[t].me=!1,l.push(e[t].nickname)}e[g].jetton-=f.value*c.length,V(e[g].nickname,f.value,l);break;case 2:for(let n=0;n<e.length;n++)e[n].jetton-=f.value;e[g].jetton+=f.value*a.value,V(e[g].nickname,f.value);break}H()},K=async()=>{await ae(),d.value.focus()},x=P([]),V=(l,n,t)=>{switch(b.value){case 1:if(n=="")return;x.unshift(`${l} 支付给 ${t}: ${n}`);break;case 2:x.unshift(`${l} 通吃: ${n}`);break;default:console.error("???");break}},H=()=>{f.value="",O.value=!1,c.length=0,o.value=!1,e[g].bedoing=!1,g=-1};return(l,n)=>i(h)?(w(),_("div",be,[F(ee,{name:"list",tag:"div",class:"playerbox w-full max-w-5xl min-h-[80vh] mt-1 mb-8 flex flex-wrap justify-around gap-y-2"},{default:W(()=>[(w(!0),_(G,null,N(i(e),t=>(w(),re(he,{key:t,player:t,cnn:i(m),headcount:i(a),working:i(o),onChange:S,onLose:z,onWin:A,onGetOut:J,onNothing:Q,onEnqueue:M},null,8,["player","cnn","headcount","working"]))),128))]),_:1}),s("div",xe,[v(s("div",{onClick:E,class:j(["btn",i(o)?"opacity-50 cursor-not-allowed":"cursor-pointer"])}," 修改昵称",2),[[k,!i(m)]]),v(s("div",{onClick:L,class:j(["btn",i(o)?"opacity-50 cursor-not-allowed":"cursor-pointer"])}," 完成 ",2),[[k,i(m)]]),v(s("div",{onClick:D,class:j(["btn",i(o)?"opacity-50 cursor-not-allowed":"cursor-pointer"])},"加入 ",2),[[k,i(a)<10]]),s("div",{onClick:R,class:j(["btn",i(o)?"cursor-pointer":"opacity-50 cursor-not-allowed"])},"确认",2)]),v(s("div",we,[v(s("input",{ref_key:"iptPaying",ref:d,type:"number",pattern:"\\d*",placeholder:i($),"onUpdate:modelValue":n[0]||(n[0]=t=>te(f)?f.value=t:f=t),onKeyup:ne(X,["enter"]),class:"mt-12 text-2xl text-center w-full border-none rounded-lg outline-none py-2 bg-white/90 dark:bg-neutral-900/90"},null,40,ke),[[le,i(f)]])],512),[[k,i(O)]]),v(s("div",_e,[$e,(w(!0),_(G,null,N(x,t=>(w(),_("div",Ce,I(t),1))),256))],512),[[k,x.length>0]])])):(w(),_("div",ve,[F(se,{list:["请选择参与人数"],loop:!1,speed:50}),s("div",ye,[(w(),_(G,null,N(9,t=>s("div",{key:t,onClick:C=>y(t+1),class:"w-1/4 text-center leading-10 hover:text-yali-yel cursor-pointer transition-all duration-300 border border-dotted select-none"},I(t+1),9,me)),64))])]))}},Ee=U(je,[["__scopeId","data-v-9d60422b"]]);export{Ee as default};
