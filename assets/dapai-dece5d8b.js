import{x as T,r as y,y as D,a as G,b as p,c as h,g as B,w as S,l as g,f as i,u as o,t as k,v,T as z,n as b,j as F,F as E,k as N,z as I,q as V}from"./index-b8a4f2d1.js";import{t as W}from"./type-9ee3573f.js";import{m as x}from"./mes-59c1356a.js";const q=["id"],U={class:"absolute top-0 left-0 w-full h-full bg-neutral-50/70 dark:bg-neutral-900/70 flex flex-wrap overflow-hidden"},A=["id"],H=["value"],J={__name:"player",props:{player:{type:Object,default:()=>{}},cnn:{type:Boolean,default:!1},headcount:{type:Number,default:2}},emits:["change"],setup(s,{emit:d}){const t=s,a=c=>{let n=c.target.value;n.length>10&&(x({type:"error",text:"少点字儿吧",time:2e3}),n=c.target.value=n.slice(0,10).trim()),d("change",n,t.player.id)};T(()=>t.cnn,(c,n)=>{!c&&t.player.nickname.length<=0&&(x({type:"error",text:"昵称怎么能空着呢",time:2e3}),d("change",`昵称${t.player.id.slice(-6)}`,t.player.id))});let l=y(!1),u=y(!1),f=D(()=>`dapai${t.player.id}`),w=D(()=>`tc${t.player.id}`),m=c=>{let n=document.getElementById(f.value);n&&(n.contains(c.target)&&!t.player.bedoing&&!u.value&&l.value?u.value=!0:(l.value=!1,u.value=!1))};T(l,(c,n)=>{setTimeout(()=>{c?window.addEventListener("click",m):window.removeEventListener("click",m)},0)});const _=()=>{t.cnn||t.player.bedoing||(l.value=!0)},C=()=>{d("lose",t.player.nickname,t.player.id)},$=()=>{d("win",t.player.nickname,t.player.id)},j=async()=>{if(t.headcount<=2){x({type:"error",text:"玩家人数过少",time:2e3}),l.value=!1;return}u.value&&d("getOut",t.player.nickname,t.player.id)},O=()=>{d("nothing",t.player.nickname,t.player.id)};return G(()=>{window.removeEventListener("click",m)}),(c,n)=>(p(),h("div",{onClickCapture:_,id:o(f),class:b(["relative w-5/12 min-h-24 border select-none flex justify-center items-center flex-col gap-2",{"cursor-pointer":!s.cnn&&!o(l)},{"opacity-50":s.player.bedoing}])},[B(z,{name:"fade"},{default:S(()=>[g(i("div",U,[i("div",{onClick:C,class:"doing-btn border-r border-b cursor-pointer"},"支出"),i("div",{onClick:$,class:"doing-btn border-l border-b cursor-pointer"},"通杀"),i("div",{onClick:j,id:o(w),class:"doing-btn border-r border-t cursor-pointer"},k(o(u)?"确认":"退出"),9,A),i("div",{onClick:O,class:"doing-btn border-l border-t"})],512),[[v,o(l)]])]),_:1}),g(i("span",{class:"basis-1/3 text-2xl w-3/4 flex justify-center items-center"},k(s.player.nickname),513),[[v,!s.cnn]]),g(i("input",{type:"text",value:s.player.nickname,onInput:a,class:"basis-1/3 text-2xl text-center w-full border-none outline-none p-0 bg-white dark:bg-neutral-900"},null,40,H),[[v,s.cnn]]),i("span",{class:b(s.player.jetton>0?"text-emerald-500 dark:text-emerald-300":s.player.jetton==0?"":"text-rose-600 dark:text-rose-500")},k(s.player.jetton),3)],42,q))}};const K={key:0,class:"min-h-[80vh] text-2xl flex flex-col justify-center items-center gap-8"},M={class:"relative w-9/12 max-w-xs flex flex-wrap justify-evenly gap-2"},P=["onClick"],Q={key:1},R={class:"btnbox w-full flex justify-evenly items-start gap-2 select-none"},ee={__name:"dapai",setup(s){let d=y(!1),t=y(2),a=F([]),l=y(!1);const u=n=>{t.value=n,d.value=!0;for(let r=0;r<n;r++)a.push({id:r.toString(),nickname:`好运${r+1}号`,jetton:0,bedoing:!1})};let f=y(!1);const w=()=>{if(l.value){x({type:"error",text:"非法操作",time:2e3});return}f.value=!0},m=()=>{f.value=!1},_=(n,r)=>{let e=a.indexOf(a.find(L=>L.id==r));a[e].nickname=n},C=()=>{if(l.value){x({type:"error",text:"非法操作",time:2e3});return}a.push({id:new Date().getTime().toString(),nickname:`天问${a.length+1}号`,jetton:0,bedoing:!1}),t.value++},$=(n,r)=>{console.log(`“${n}”输掉`),l.value=!0;for(let e=0;e<a.length;e++)a[e].id===r&&(a[e].bedoing=!0)},j=(n,r)=>{console.log(`“${n}”通吃`),l.value=!0;for(let e=0;e<a.length;e++)a[e].id===r&&(a[e].bedoing=!0)},O=(n,r)=>{a.splice(a.indexOf(a.find(e=>e.id==r)),1),t.value--},c=(n,r)=>{console.log(`“${n}”没啥`);for(let e=0;e<a.length;e++)a[e].id===r&&(a[e].bedoing=!0,setTimeout(()=>{a[e].bedoing=!1},0))};return(n,r)=>o(d)?(p(),h("div",Q,[B(I,{name:"list",tag:"div",class:"playerbox w-full min-h-[80vh] mb-8 flex flex-wrap justify-around gap-y-2"},{default:S(()=>[(p(!0),h(E,null,N(o(a),e=>(p(),V(J,{key:e,player:e,cnn:o(f),headcount:o(t),onChange:_,onLose:$,onWin:j,onGetOut:O,onNothing:c},null,8,["player","cnn","headcount"]))),128))]),_:1}),i("div",R,[g(i("div",{onClick:w,class:b(["border py-2 px-4",{"opacity-50 cursor-not-allowed":o(l)}])}," 修改昵称",2),[[v,!o(f)]]),g(i("div",{onClick:m,class:b(["border py-2 px-4",{"opacity-50 cursor-not-allowed":o(l)}])}," 完成 ",2),[[v,o(f)]]),g(i("div",{onClick:C,class:b(["border py-2 px-4",{"opacity-50 cursor-not-allowed":o(l)}])},"加入",2),[[v,o(t)<10]])])])):(p(),h("div",K,[B(W,{list:["请选择参与人数"],loop:!1,speed:50}),i("div",M,[(p(),h(E,null,N(9,e=>i("div",{key:e,onClick:L=>u(e+1),class:"w-1/4 text-center leading-10 hover:text-[#fbc82f] cursor-pointer transition-all duration-300 border border-dotted select-none"},k(e+1),9,P)),64))])]))}};export{ee as default};
