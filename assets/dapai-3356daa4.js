import{_ as P,G as T,r as p,D as G,o as Y,f as w,g as _,j as K,w as U,k as v,h as s,m as o,t as I,v as k,T as Z,p as B,a as H,F as N,i as F,y as ee,z as te,H as ne,I as le,J as ae,n as re,q as ie,s as oe}from"./index-5d570e70.js";import{t as se}from"./type-c1fa2208.js";import{m as $}from"./mes-5e95585e.js";import"./utils-604c9dcf.js";const ce=["id"],ue={class:"absolute top-0 left-0 w-full h-full bg-neutral-50/70 dark:bg-neutral-900/70 flex flex-wrap overflow-hidden"},de=["id"],fe=["value"],pe={__name:"player",props:{player:{type:Object,default:()=>{}},cnn:{type:Boolean,default:!1},headcount:{type:Number,default:2},working:{type:Boolean,default:!1}},emits:["change","lose","win","get-out","nothing","enqueue"],setup(d,{emit:h}){const a=d,e=c=>{let f=c.target.value;f.length>10&&($({type:"error",text:"少点字儿吧",time:2e3}),f=c.target.value=f.slice(0,10).trim()),h("change",f,a.player.id)};T(()=>a.cnn,(c,f)=>{!c&&a.player.nickname.length<=0&&($({type:"error",text:"昵称怎么能空着呢",time:2e3}),h("change",`昵称${a.player.id.slice(-6)}`,a.player.id))});let i=p(!1),y=p(!1),m=G(()=>`dapai${a.player.id}`),D=G(()=>`tc${a.player.id}`),L=G(()=>!a.cnn&&!i.value&&!a.player.bedoing),r=c=>{let f=document.getElementById(m.value);f&&(f.contains(c.target)&&!a.player.bedoing&&!y.value&&i.value?y.value=!0:(i.value=!1,y.value=!1))};T(i,(c,f)=>{setTimeout(()=>{c?window.addEventListener("click",r):window.removeEventListener("click",r)},0)});const S=()=>{a.cnn||a.player.bedoing||(a.working?h("enqueue",a.player.id):i.value=!0)},E=()=>{h("lose",a.player.nickname,a.player.id)},b=()=>{h("win",a.player.nickname,a.player.id)},C=async()=>{if(a.headcount<=2){$({type:"error",text:"玩家人数过少",time:2e3}),i.value=!1;return}y.value&&h("get-out",a.player.nickname,a.player.id,a.player.jetton)},g=()=>{h("nothing",a.player.nickname,a.player.id)};return Y(()=>{window.removeEventListener("click",r)}),(c,f)=>(w(),_("div",{onClickCapture:S,id:o(m),class:B(["relative w-5/12 md:w-1/3 min-h-24 border select-none transition-all flex justify-center items-center flex-col gap-2",{"cursor-pointer":o(L)},d.player.bedoing?"opacity-60 cursor-not-allowed border-purple-600":a.player.me?"border-amber-600":""])},[K(Z,{name:"fade"},{default:U(()=>[v(s("div",ue,[s("div",{onClick:E,class:"doing-btn border-r border-b cursor-pointer"},"支出"),s("div",{onClick:b,class:"doing-btn border-l border-b cursor-pointer"},"通吃"),s("div",{onClick:C,id:o(D),class:"doing-btn border-r border-t cursor-pointer"},I(o(y)?"确认":"退出"),9,de),s("div",{onClick:g,class:"doing-btn border-l border-t"})],512),[[k,o(i)]])]),_:1}),v(s("span",{class:"basis-1/3 text-2xl w-3/4 flex justify-center items-center"},I(d.player.nickname),513),[[k,!d.cnn]]),v(s("input",{type:"text",value:d.player.nickname,onInput:e,class:"basis-1/3 text-2xl text-center w-full border-none outline-none p-0 bg-white dark:bg-neutral-900"},null,40,fe),[[k,d.cnn]]),s("span",{class:B(["break-all text-center",d.player.jetton>0?"text-emerald-500 dark:text-emerald-300":d.player.jetton==0?"":"text-rose-600 dark:text-rose-500"])},I(d.player.jetton),3)],42,ce))}},he=P(pe,[["__scopeId","data-v-dfdec515"]]);const ge=d=>(ie("data-v-a8015a84"),d=d(),oe(),d),ve={key:0,class:"min-h-[80vh] text-2xl flex flex-col justify-center items-center gap-8"},ye={class:"relative w-9/12 max-w-xs flex flex-wrap justify-evenly gap-2"},me=["onClick"],be={key:1,class:"w-full flex flex-col items-center"},xe={class:"btnbox w-full max-w-5xl flex justify-evenly items-start gap-2 select-none"},we={class:"fixed top-0 left-0 w-full h-full p-2 bg-neutral-800/20"},ke=["placeholder","onKeyup"],_e={class:"w-full max-w-5xl my-6 flex flex-col justify-start items-center gap-2"},$e=ge(()=>s("div",{class:"text-lg"},"历史",-1)),Ce={class:"w-full p-2 text-center"},je={__name:"dapai",setup(d){let h=p(!1),a=p(2),e=H([]),i=p(!1);const y=n=>{a.value=n,h.value=!0;for(let l=0;l<n;l++)e.push({id:l.toString(),nickname:`好运${l+1}号`,jetton:0,bedoing:!1,me:!1})};let m=p(!1);const D=()=>{if(i.value){$({type:"error",text:"非法操作",time:2e3});return}m.value=!0},L=()=>{m.value=!1,r.length>0&&r[0]!=""&&x.unshift(`"${r[r.length-1]}" 改名为 "${r[0]}"`),r=[]};let r=[];const S=(n,l)=>{let t=e.indexOf(e.find(j=>j.id==l));r.length>=2&&(e[t].nickname==r[0]?(r.shift(),r.unshift(n)):(x.unshift(`"${r[r.length-1]}" 改名为 "${r[0]}"`),r.length=0)),r.length==0&&(r.unshift(e[t].nickname),r.unshift(n)),e[t].nickname=n},E=()=>{if(i.value){$({type:"error",text:"非法操作",time:2e3});return}e.push({id:new Date().getTime().toString(),nickname:`天问${e.length+1}号`,jetton:0,bedoing:!1,me:!1}),a.value++,x.unshift(`"天问${e.length}号" 加入`)};let b=p(0),C=p("");T(b,(n,l)=>{switch(b.value){case 1:C.value="支出点数";break;case 2:C.value="通吃点数";break;default:C.value="点数";break}});let g;const c=[];let f=p(null);const W=(n,l)=>{i.value=!0,b.value=1;for(let t=0;t<e.length;t++)e[t].id===l&&(e[t].bedoing=!0,g=t)},J=n=>{for(let l=0;l<e.length;l++)e[l].id===n&&(e[l].me=!e[l].me)};let O=p(!1),u=p();T(u,(n,l)=>{n>999&&(u.value=999),n<0&&(u.value=0)});const M=()=>{if(!i.value){$({type:"warn",text:"温馨提示：用于确认收款人",time:2e3});return}for(let n=0;n<e.length;n++)e[n].me===!0&&c.push(e[n].id);for(let n=0;n<e.length&&e[n].me!=!0;n++)if(n>=e.length-1){q();return}O.value=!0,V()},R=(n,l)=>{i.value=!0,b.value=2;for(let t=0;t<e.length;t++)e[t].id===l&&(e[t].bedoing=!0,g=t);O.value=!0,V()},A=(n,l,t)=>{e.splice(e.indexOf(e.find(j=>j.id==l)),1),a.value--,x.unshift(`"${n}" 退出 点数为 ${t}`)},Q=(n,l)=>{for(let t=0;t<e.length;t++)e[t].id===l&&(e[t].bedoing=!0,setTimeout(()=>{e[t].bedoing=!1},0))},X=()=>{if(typeof u.value!="number"){$({type:"error",text:"非法数据",time:2e3}),q();return}switch(b.value){case 1:let n=[];for(let l=0;l<c.length;l++){let t=e.indexOf(e.find(j=>j.id==c[l]));e[t].jetton+=u.value,e[t].me=!1,n.push(e[t].nickname)}e[g].jetton-=u.value*c.length,z(e[g].nickname,u.value,n);break;case 2:for(let l=0;l<e.length;l++)e[l].jetton-=u.value;e[g].jetton+=u.value*a.value,z(e[g].nickname,u.value);break}q()},V=async()=>{await ae(),f.value.focus()},x=H([]),z=(n,l,t)=>{switch(b.value){case 1:if(l=="")return;x.unshift(`${n} 支付给 ${t}: ${l}`);break;case 2:x.unshift(`${n} 通吃: ${l}`);break;default:console.error("???");break}},q=()=>{u.value="",O.value=!1,c.length=0,i.value=!1,e[g].bedoing=!1,g=-1;for(let n=0;n<e.length;n++)e[n].me=!1};return(n,l)=>o(h)?(w(),_("div",be,[K(ee,{name:"list",tag:"div",class:"playerbox w-full max-w-5xl min-h-[80vh] mt-1 mb-8 flex flex-wrap justify-around gap-y-2"},{default:U(()=>[(w(!0),_(N,null,F(o(e),t=>(w(),re(he,{key:t,player:t,cnn:o(m),headcount:o(a),working:o(i),onChange:S,onLose:W,onWin:R,onGetOut:A,onNothing:Q,onEnqueue:J},null,8,["player","cnn","headcount","working"]))),128))]),_:1}),s("div",xe,[v(s("div",{onClick:D,class:B(["btn",o(i)?"opacity-50 cursor-not-allowed":"cursor-pointer"])}," 修改昵称",2),[[k,!o(m)]]),v(s("div",{onClick:L,class:B(["btn",o(i)?"opacity-50 cursor-not-allowed":"cursor-pointer"])}," 完成 ",2),[[k,o(m)]]),v(s("div",{onClick:E,class:B(["btn",o(i)?"opacity-50 cursor-not-allowed":"cursor-pointer"])},"加入 ",2),[[k,o(a)<10]]),s("div",{onClick:M,class:B(["btn",o(i)?"cursor-pointer":"opacity-50 cursor-not-allowed"])},"确认",2)]),v(s("div",we,[v(s("input",{ref_key:"iptPaying",ref:f,type:"number",pattern:"\\d*",placeholder:o(C),"onUpdate:modelValue":l[0]||(l[0]=t=>te(u)?u.value=t:u=t),onKeyup:ne(X,["enter"]),class:"mt-12 text-2xl text-center w-full border-none rounded-lg outline-none py-2 bg-white/90 dark:bg-neutral-900/90"},null,40,ke),[[le,o(u)]])],512),[[k,o(O)]]),v(s("div",_e,[$e,(w(!0),_(N,null,F(x,t=>(w(),_("div",Ce,I(t),1))),256))],512),[[k,x.length>0]])])):(w(),_("div",ve,[K(se,{list:["请选择参与人数"],loop:!1,speed:50}),s("div",ye,[(w(),_(N,null,F(9,t=>s("div",{key:t,onClick:j=>y(t+1),class:"w-1/4 text-center leading-10 hover:text-yali-yel cursor-pointer transition-all duration-300 border border-dotted select-none"},I(t+1),9,me)),64))])]))}},De=P(je,[["__scopeId","data-v-a8015a84"]]);export{De as default};
